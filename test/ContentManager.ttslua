---
--- Generated by Luanalysis
--- Created by PolyphonyRequiem.
--- DateTime: 7/30/2020 2:22 PM
---

local test = function()
  local base_v2 = "https://raw.githubusercontent.com/TwilightImperiumContentCreators/TTS-TwilightImperium/master/content-packages/base-v2.json";
  print ('fetching from ' ..  base_v2);
  WebRequest.get(base_v2, handleRequest);
end

---@param request tts__WebRequest
function handleRequest (request)
  print ('handling request');
  if request.is_done then
    local ContentManager = require("src/ContentManager");
    local contentManager = ContentManager:new();

    ---@type ContentPackage
    local package = JSON.decode(request.text);
    contentManager:addContentPackage(package);

    local content = contentManager:flatten();

    print(content.assets.decks[1].id)
  end
end

return test;
